{
  "project_name": "Finance App Project",
  "version": "v5.5",
  "author": "Danilo Uchoa",
  "description": "Aplicação completa de controle financeiro pessoal (frontend React + Tailwind, backend Node.js + TypeScript + Prisma + MongoDB), com autenticação JWT, rotas RESTful e suporte a despesas fixas, recorrentes e compartilhadas. A versão v5.5 introduz processamento assíncrono com RabbitMQ e worker dedicado para replicação de despesas recorrentes.",
  "architecture": {
    "frontend": {
      "framework": "React 18 (Vite)",
      "style": "TailwindCSS",
      "state_management": "useState + Custom Hook useFinanceApp()",
      "api_integration": "REST via Axios (autenticação JWT)",
      "components": [
        "Dashboard",
        "Lançamentos",
        "Salário",
        "Cadastros",
        "Exportação",
        "UI Components (Tabs, Section, Field)"
      ]
    },
    "backend": {
      "framework": "Express + TypeScript",
      "database": "MongoDB (via Prisma ORM)",
      "authentication": "JWT (jsonwebtoken ^9.0.2)",
      "services": {
        "RabbitMQ": "CloudAMQP (amqplib ^0.10.9, @types/amqplib)",
        "Prisma": "v6.19.0",
        "Async Jobs": "Worker Node.js conectado ao RabbitMQ via recurring-jobs queue",
        "Recurring Service": "processRecurringExpenses() duplica despesas fixas/recorrentes mensalmente"
      },
      "routes": [
        "/api/status",
        "/api/auth",
        "/api/expenses",
        "/api/origins",
        "/api/debtors",
        "/api/salaryHistory"
      ],
      "docker_services": [
        "backend (porta 4000)",
        "frontend (porta 5173)",
        "mongodb (porta 27017)",
        "worker (processa fila recurring-jobs no RabbitMQ)"
      ]
    }
  },
  "key_updates": {
    "RabbitMQ_integration": [
      "Adicionado amqplib + @types/amqplib",
      "Criado src/lib/rabbit.ts com connectRabbit() e publishRecurringJob()",
      "Adicionado worker src/workers/recurringWorker.ts que consome fila recurring-jobs",
      "Nova rota POST /api/expenses/recurring/queue para acionar job assíncrono",
      "Atualizado docker-compose.yaml para incluir serviço worker"
    ],
    "Recurring_expenses": [
      "Implementado src/services/recurringService.ts com lógica de duplicação automática",
      "Campos originId e debtorId tornados opcionais (String?) no schema.prisma",
      "Helpers centralizados em src/utils/expenseHelpers.ts com buildCreateData e validateFlags",
      "Correção de tipagem TS2322 (originId null-safe via ?? undefined)"
    ],
    "Schema_and_serialization": [
      "createdAt e updatedAt tornam-se opcionais e com default automático",
      "Serialização de despesas adaptada para campos nulos/antigos",
      "Prisma sincronizado com MongoDB via npx prisma db push"
    ]
  },
  "local_run_instructions": [
    "cd backend",
    "npm install  # instala amqplib + @types/amqplib",
    "npx prisma generate",
    "npx prisma db push  # garante compatibilidade com campos opcionais",
    "npm run build  # deve compilar sem erros TS",
    "docker compose up -d --build  # inicia API + worker + MongoDB + frontend",
    "curl -X POST http://localhost:4000/api/expenses/recurring/queue  # testa fila assíncrona"
  ],
  "expected_behavior": {
    "worker_logs": "{ created, skipped } para cada job processado",
    "api_behavior": "Respostas rápidas mesmo com despesas recorrentes pesadas",
    "queue_handling": "Jobs persistentes, reprocessamento automático em caso de erro (RabbitMQ nack)"
  },
  "release_notes": "v5.5 conclui a transição para arquitetura assíncrona com RabbitMQ, corrigindo tipagens e sincronizando schema Prisma para campos opcionais."
}
