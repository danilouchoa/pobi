{
  "codex_memory": {
    "project": "Finance App Project",
    "version": "v6.6.0 (CI/CD Seguro + Scanners SAST/DAST + GitOps Futuro)",
    "description": "AplicaÃ§Ã£o fullstack de controle financeiro (React + Express + Prisma + MongoDB + RabbitMQ + Upstash Redis + httpOnly Cookies) com pipelines CI/CD integradas, automaÃ§Ã£o de deploy (Vercel + Render / Kubernetes), seguranÃ§a contÃ­nua (Qodana, Semgrep, Snyk, OWASP ZAP) e planejamento de GitOps/Canary.",
    "milestones": [
      {
        "id": 21,
        "tag": "[Security/DX] Qodana, Semgrep, Snyk e OWASP ZAP Integrados",
        "status": "ğŸŸ¡ Em progresso (Qodana âœ…, demais configurando)",
        "summary": "IntegraÃ§Ã£o das ferramentas de anÃ¡lise estÃ¡tica e dinÃ¢mica de seguranÃ§a (SAST/DAST) nos pipelines GitHub Actions.",
        "notes": [
          "âœ… Qodana JS ativo com workflow qodana.yml (CI Security Analysis)",
          "âœ… 116 findings iniciais (76 ESLint, 4 hardcoded passwords, demais warnings de import e redundÃ¢ncia)",
          "âœ… ComentÃ¡rios automÃ¡ticos em PR via Qodana Bot",
          "ğŸŸ¡ Semgrep configurado para detectar injeÃ§Ãµes, SSRF, secrets e XSS em JS/TS",
          "ğŸŸ¡ Snyk integrado para auditoria de vulnerabilidades npm/yarn (package.json + lockfiles)",
          "ğŸŸ¡ OWASP ZAP configurado para varredura DAST no ambiente staging (Kubernetes OKE) - detectando headers inseguros e endpoints expostos",
          "ğŸ”’ Severities High/Critical bloqueiam merge automÃ¡tico via required checks",
          "ğŸ“Š Security Dashboard consolidando mÃ©tricas por scanner e PR",
          "ğŸ“˜ DocumentaÃ§Ã£o: SECURITY_SCANNERS.md",
          "ğŸ”§ Plano de aÃ§Ã£o Qodana: regenerar SARIF, corrigir EditorConfig, ajustar templates Angular e CSS/PostCSS, reexecutar Qodana e manter o gate bloqueando severidades High/Critical"
        ]
      },
      {
        "id": 22,
        "tag": "[Security] GestÃ£o de Secrets e ENVs",
        "status": "ğŸŸ¢ ConcluÃ­do (Fase 1)",
        "summary": "Cadastro de variÃ¡veis sensÃ­veis e tokens nos GitHub Secrets e ocultaÃ§Ã£o de valores em logs/pipelines.",
        "notes": [
          "âœ… Todos os tokens, keys e conexÃµes (.env) migrados para GitHub Secrets (org-level e repositÃ³rio)",
          "âœ… Workflows atualizados para ler via secrets.GITHUB_TOKEN e secrets.PRODUCTION_ENV",
          "âœ… RepositÃ³rio configurado com ENV placeholders (template .env.example atualizado)",
          "âœ… Logs ofuscados em CI (masks adicionadas via core.setSecret)",
          "ğŸŸ¡ PrÃ³xima etapa: refatorar pipelines para injetar secrets diretamente em manifests Kubernetes (kubectl set env / kustomize patches)",
          "ğŸ“˜ DocumentaÃ§Ã£o: ENV_SECURITY_GUIDE.md"
        ]
      },
      {
        "id": 23,
        "tag": "[CI/CD] Continuous Deployment no Kubernetes (OCI OKE)",
        "status": "ğŸŸ¡ Em Progresso",
        "summary": "ImplementaÃ§Ã£o de CD automatizado com deploy seguro no cluster Kubernetes gratuito da Oracle Cloud (OKE).",
        "notes": [
          "ğŸ§© Deploy automatizado via GitHub Actions â†’ kubectl apply com contexto configurado (OCI CLI + kubeconfig)",
          "ğŸ§© Imagens publicadas no OCIR (Oracle Container Registry) com autenticaÃ§Ã£o via GitHub Secrets",
          "âœ… Ambientes configurados: staging (namespace staging) e production (namespace production)",
          "âœ… Branch main â†’ production | feature/* â†’ staging",
          "âš™ï¸ Deploy automatizado no merge com CI verde e scanners sem falhas crÃ­ticas",
          "ğŸ“¦ Rollback via Helm history / kubectl rollout undo",
          "ğŸŸ¡ Planejamento GitOps â†’ Canary Deploy (progressive rollout via tags e auto-promotion)",
          "ğŸ“˜ DocumentaÃ§Ã£o: DEPLOY_PIPELINE_K8S_GUIDE.md"
        ]
      },
      {
        "id": 24,
        "tag": "[Security] GitOps & Canary Strategy (Planejado)",
        "status": "ğŸŸ¡ Planejado",
        "summary": "Planejar e aplicar prÃ¡ticas GitOps com fluxos de Canary Deploy no Kubernetes de produÃ§Ã£o.",
        "notes": [
          "ğŸ¯ Meta: adotar GitOps (ArgoCD ou FluxCD) para sincronizaÃ§Ã£o declarativa de ambientes",
          "ğŸ¯ Deploy Canary para validaÃ§Ã£o progressiva de novas versÃµes",
          "ğŸ¯ Automatizar rollback baseado em mÃ©tricas de healthcheck, logs e Prometheus metrics",
          "ğŸ¯ Integrar com observabilidade futura (Grafana/Loki/Prometheus)",
          "ğŸ¯ Documentar padrÃµes: PR â†’ Deploy Canary â†’ PromoÃ§Ã£o automÃ¡tica apÃ³s 95% sucesso",
          "ğŸ“˜ DocumentaÃ§Ã£o: GITOPS_CANARY_PLAN.md"
        ]
      },
      {
        "id": 25,
        "tag": "[DX/Security] CÃ³digo Seguro e OcultaÃ§Ã£o de VariÃ¡veis",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Melhorias estruturais para ocultar variÃ¡veis e segredos no cÃ³digo e pipelines.",
        "notes": [
          "âœ… SubstituiÃ§Ã£o completa de variÃ¡veis hardcoded por process.env.*",
          "âœ… Removidas credenciais mock de testes e substituÃ­das por fixtures seguras",
          "âœ… CÃ³digo revisado pelo Qodana e Semgrep (nenhum secret em plaintext)",
          "âœ… README atualizado com diretrizes de .env seguro e mÃ¡scaras de logs",
          "âœ… HistÃ³rico das branches main e ci/qodana-environment reescrito via branch Ã³rfÃ£ sanitized-* com secrets removidos e tags de backup (pre-sanitize-main / pre-sanitize-ci-qodana) em Nov/2025",
          "ğŸŸ¡ PendÃªncia: propagar alteraÃ§Ãµes de variÃ¡veis para workflows CI/CD (nÃ£o aplicado ainda)",
          "ğŸ“˜ DocumentaÃ§Ã£o: SAFE_ENV_CODING_GUIDE.md"
        ]
      },
      {
        "id": 20,
        "tag": "[DX] CI Pipeline (Backend & Frontend)",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Pipelines GitHub Actions para backend e frontend garantindo lint, build, testes, cobertura e proteÃ§Ã£o de branch.",
        "notes": [
          "âœ… Workflows ci-backend.yml e ci-frontend.yml ativos (push e PR para main)",
          "âœ… Node 20 + cache npm (setup-node)",
          "âœ… Etapas: install, lint, build/tsc, vitest + cobertura, upload artifacts",
          "âœ… Status checks requeridos antes de merge em main",
          "âœ… Auto-merge de Dependabot depende dos checks verdes",
          "ğŸ“Š MÃ©trica alvo: execuÃ§Ã£o <5min total cada pipeline",
          "ğŸ§ª Cobertura publicada como artifact para inspeÃ§Ã£o",
          "ğŸ”’ Branch protection configurada (GH006 aplicado em push direto)"
        ]
      },
      {
        "id": 19,
        "tag": "[DX] AtualizaÃ§Ã£o AutomÃ¡tica de DependÃªncias",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Dependabot diÃ¡rio para backend e frontend com auto-label e auto-merge condicional.",
        "notes": [
          "âœ… Arquivo dependabot.yml configurado (interval daily 14:02 BRT, timezone America/Sao_Paulo)",
          "âœ… Labels automÃ¡ticas: dependencies, auto-update",
          "âœ… Workflow dependabot-auto-merge.yml para fusÃ£o automÃ¡tica com CI verde",
          "âœ… PRs recentes: bump express-rate-limit 8.2.1",
          "âœ… Branch main protegida - merges apenas via PR",
          "ğŸ“Œ Objetivo: nenhuma dependÃªncia crÃ­tica >1 versÃ£o minor atrasada",
          "ğŸ›¡ï¸ SeguranÃ§a: patches aplicados em <24h",
          "ğŸ—‚ï¸ DocumentaÃ§Ã£o no README (seÃ§Ã£o Milestone #19)"
        ]
      },
      {
        "id": 9,
        "tag": "[FE] Toasts & Empty States",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Feedbacks visuais consistentes (toasts) e placeholders de listas vazias (empty states) implementados em todas as telas CRUD, com cÃ³digo totalmente documentado.",
        "notes": [
          "âœ… notistack instalado e SnackbarProvider configurado globalmente (top-right, max 3, 3s duration)",
          "âœ… Hook useToast() criado com success/error/info/warning e prevenÃ§Ã£o de duplicidade (debounce 2s + timestamp)",
          "âœ… Componente EmptyState.tsx (MUI) com props title/description/ctaLabel/onCtaClick/icon",
          "âœ… mapBackendError() traduzindo cÃ³digos tÃ©cnicos (E_VALIDATION, E_DUPLICATE, etc) em mensagens legÃ­veis",
          "âœ… Toasts integrados em Lancamentos (5 operaÃ§Ãµes), Cadastros (7 operaÃ§Ãµes), SalÃ¡rio (2 operaÃ§Ãµes)",
          "âœ… EmptyStates integrados: Lancamentos (1), Categorias (1), Origens (1), Devedores (1)",
          "âœ… 100% do cÃ³digo comentado com JSDoc e documentaÃ§Ã£o inline",
          "âœ… CritÃ©rios de aceite: 14 operaÃ§Ãµes com toasts, 4 empty states, zero erros console",
          "âœ… Documento completo: MILESTONE_9_COMPLETE.md com arquitetura e exemplos"
        ]
      },
      {
        "id": 17,
        "tag": "[DX] Storybook",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Storybook configurado com tema MUI, stories reais para MonthNavigator, KPI e EmptyState, sem exemplos quebrados.",
        "notes": [
          "âœ… Storybook 10.x com Vite e ThemeProvider global",
          "âœ… Stories reais: MonthNavigator, KPI, EmptyState",
          "âœ… RemoÃ§Ã£o de exemplos quebrados",
          "âœ… Zero warnings/erros no build",
          "âœ… CritÃ©rios de aceite: stories reais, tema aplicado, sem exemplos quebrados"
        ]
      },
      {
        "id": 14,
        "tag": "[BE] Dead Letter Queue (DLQ)",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "DLQ implementada no RabbitMQ com retry, backoff, endpoints admin e integraÃ§Ã£o nos workers.",
        "notes": [
          "âœ… DLQ via dead-letter-exchange e argumentos de fila",
          "âœ… Retry automÃ¡tico com backoff exponencial",
          "âœ… Endpoints admin: /api/dlq/stats, /api/dlq/messages, /api/dlq/reprocess/:id, /api/dlq/purge",
          "âœ… ProteÃ§Ã£o JWT nos endpoints",
          "âœ… Logs detalhados de falhas e reprocessamentos",
          "âœ… Workers bulk/recurring integrados com DLQ",
          "âœ… CritÃ©rios de aceite: mensagens na DLQ apÃ³s retries, admin funcional, testes manuais"
        ]
      },
      {
        "id": 10,
        "tag": "[DX] Healthchecks e Docker Prod",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Aprimorar observabilidade e robustez de execuÃ§Ã£o em contÃªineres com healthchecks completos.",
        "notes": [
          "âœ… Endpoint /api/health: Verifica Mongo (ping), Redis (PING) e RabbitMQ (connect+channel)",
          "âœ… Retorna JSON com status, uptime, latÃªncia de cada dependÃªncia",
          "âœ… Status HTTP: 200 (ok) | 503 (unhealthy/degraded)",
          "âœ… Script health:db (check-db.ts): VerificaÃ§Ã£o standalone do MongoDB com output detalhado",
          "âœ… Healthcheck Docker backend: curl -f http://localhost:4000/api/health (interval: 30s)",
          "âœ… Healthcheck Docker workers: kill -0 1 (verifica se PID 1 estÃ¡ vivo)",
          "âœ… Healthcheck Docker mongo: mongosh --eval 'db.adminCommand(ping)'",
          "âœ… Depends_on com condition: service_healthy - workers sÃ³ iniciam apÃ³s backend healthy",
          "âœ… Frontend depende de backend healthy - evita erros de conexÃ£o",
          "âœ… Dockerfile: curl instalado no stage runtime para healthchecks",
          "âœ… Todos os containers com STATUS=healthy validados via docker ps",
          "âœ… Endpoint /ready: Readiness probe para compatibilidade futura com Kubernetes"
        ]
      },
      {
        "id": 11,
        "tag": "[Security] ValidaÃ§Ã£o de Rota (Zod)",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Sistema completo de validaÃ§Ã£o de entrada (body/query/params) usando Zod, com middleware genÃ©rica, schemas por recurso, feature flag e logs limpos.",
        "notes": [
          "âœ… 5 schemas criados: expense (180L), origin (160L), auth (80L), salary (100L), catalog (90L)",
          "âœ… Middleware validation.ts (290L): aceita body/query/params, retorna 400 padronizado, respeita VALIDATION_ENABLED",
          "âœ… Formato de erro: { error, message, details: [{ field, message }] } - sem stack-trace",
          "âœ… Feature flag VALIDATION_ENABLED no config.ts (default: true, permite rollback)",
          "âœ… 18 rotas validadas: expenses (4), origins (4), auth (2), salary (4), debtors (4)",
          "âœ… ValidaÃ§Ãµes monetÃ¡rias: string formato '0.00' com regex /^\\d+\\.\\d{2}$/",
          "âœ… ValidaÃ§Ãµes de datas: z.coerce.date() para ISO 8601, ranges validados",
          "âœ… ValidaÃ§Ãµes de IDs: ObjectId MongoDB (24 chars hex) com regex",
          "âœ… ValidaÃ§Ã£o condicional: closingDay obrigatÃ³rio quando type='CartÃ£o'",
          "âœ… SeguranÃ§a: .strict() rejeita campos extras (previne mass assignment)",
          "âœ… Telemetria: contadores validationFailures (por rota) e validationFailuresByField",
          "âœ… FunÃ§Ã£o getValidationMetrics() para debugging e monitoramento",
          "âœ… Logs nÃ­vel 'warn' SEM stack-trace para erros esperados de validaÃ§Ã£o",
          "âœ… ConvenÃ§Ãµes: createXxxSchema, updateXxxSchema (.partial()), queryXxxSchema, idParamSchema",
          "âœ… DocumentaÃ§Ã£o completa consolidada no README.md (seÃ§Ã£o Milestone #11)",
          "ğŸ› v6.2.1 FIX: queryExpenseSchema ajustado para aceitar mode=calendar, year, limit=1000 (compatibilidade frontend)",
          "ğŸ› v6.2.1 FIX: Middleware corrigido para nÃ£o sobrescrever req.query (read-only no Express)",
          "âœ… v6.2.1 TEST: Todas as rotas validadas retornando 200 OK (expenses, origins, salary, debtors)",
          "âœ… v6.2.1 STATUS: Sistema 100% funcional em produÃ§Ã£o sem erros 400/500"
        ]
      },
      {
        "id": 13,
        "tag": "[Security] Auth httpOnly Cookies",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "MigraÃ§Ã£o de localStorage (vulnerÃ¡vel a XSS) para cookies httpOnly + tokens em memÃ³ria, com refresh automÃ¡tico e validaÃ§Ã£o real de credenciais.",
        "notes": [
          "âœ… Arquitetura de 2 tokens: Access Token (15min, memÃ³ria) + Refresh Token (7d, cookie httpOnly)",
          "âœ… Backend: 4 endpoints (login, register, refresh, logout) com bcrypt + JWT",
          "âœ… Cookies httpOnly: secure (HTTPS prod), sameSite: strict (previne CSRF), inacessÃ­vel via JS",
          "âœ… ValidaÃ§Ã£o real: bcrypt.compare() para senhas, mensagens genÃ©ricas (previne enumeraÃ§Ã£o)",
          "âœ… Auto-refresh: Frontend intercepta 401, chama /auth/refresh automaticamente",
          "âœ… CORS: credentials: true no backend + withCredentials: true no frontend",
          "âœ… cookie-parser: Instalado no backend para ler req.cookies",
          "âœ… Logs seguros: Login success/fail com email/IP (SEM senha/token)",
          "âœ… Frontend: Token em memÃ³ria (state), user cacheado (localStorage), logout chama backend",
          "âœ… Testes: register, login, refresh, logout, credenciais invÃ¡lidas - TODOS PASSANDO",
          "âœ… Breaking change: UsuÃ¡rios precisam fazer login novamente (tokens antigos invÃ¡lidos)",
          "âœ… DocumentaÃ§Ã£o: 1000+ linhas no README com diagramas, fluxos, troubleshooting",
          "âœ… SeguranÃ§a: XSS prevenido (httpOnly), CSRF prevenido (sameSite: strict)",
          "âœ… DependÃªncias: cookie-parser@1.4.6 + @types/cookie-parser@1.4.7"
        ]
      },
      {
        "id": 16,
        "tag": "[DX] Testes Automatizados",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Cobertura de testes automatizados (unitÃ¡rios e integraÃ§Ã£o) para backend (Vitest + Supertest) e frontend (RTL), garantindo estabilidade, confianÃ§a e CI/CD robusta.",
        "notes": [
          "âœ… Backend: Vitest + Supertest para rotas, services, workers, helpers (auth, expenses, billing, validation)",
          "âœ… Testes de integraÃ§Ã£o: /auth/login, /auth/refresh, /auth/logout (cookies), CRUD /expenses, filtros UTC, billingMonth",
          "âœ… Testes unitÃ¡rios: deriveBillingMonth(), adjustToBusinessDay(), workers (ACK/NACK, reconexÃ£o)",
          "âœ… Mock global de clock (UTC fixo)",
          "âœ… Seeds determinÃ­sticos (seed=42), banco in-memory/mocks, sem tocar produÃ§Ã£o",
          "âœ… Mocks centralizados (__mocks__/), reset antes de cada teste",
          "âœ… Rodar via npm run test:backend, logs enxutos (--silent)",
          "âœ… Frontend: React Testing Library (RTL) + Vitest",
          "âœ… Testes de componentes: MonthNavigator (troca mÃªs, labels, animaÃ§Ã£o), EmptyState (renderizaÃ§Ã£o, CTA)",
          "âœ… Testes de hooks: useExpenses (fetch/mutation, toasts), useToast (debounce/chave Ãºnica)",
          "âœ… Testes de contexto: AuthContext (login/logout, mock cookies)",
          "âœ… Providers mockados: QueryClient, Theme, Toast",
          "âœ… Mocks de API: MSW ou axios-mock-adapter",
          "âœ… Rodar via npm run test:frontend, cobertura >80% em /hooks e /components/ui",
          "âœ… Cobertura mÃ­nima 80% linhas/branches backend (src/services, src/routes, src/utils) e frontend (src/hooks, src.components.ui)",
          "âœ… CI executa npm run test:backend e npm run test:frontend, falha se cobertura <80%",
          "âœ… RelatÃ³rio HTML (coverage/index.html)",
          "âœ… Nomes descritivos, mocks centralizados, clock global, seeds fixos, testes idempotentes",
          "âœ… Nenhum teste depende de latÃªncia real, logs silenciosos, scripts package.json comentados",
          "âœ… TESTING_GUIDE.md: estrutura, comandos, troubleshooting, tabela mÃ³dulosâ†”testes, boas prÃ¡ticas",
          "âœ… CritÃ©rios de aceite: tudo acima implementado, sem flakiness, cobertura >80%, documentaÃ§Ã£o completa"
        ]
      },
      {
        "id": 0,
        "tag": "[BUG] Fatura de CartÃ£o (closingDay + dia Ãºtil + billingMonth)",
        "status": "ğŸŸ¢ ConcluÃ­do (Backend)",
        "summary": "Classificar despesas de cartÃ£o pela fatura correta com base no dia de fechamento (ajustado para dia Ãºtil), gravando billingMonth automaticamente.",
        "notes": [
          "âœ… Schema atualizado: Origin.closingDay (Int), Origin.billingRolloverPolicy (NEXT|PREVIOUS), Expense.billingMonth (YYYY-MM) + Ã­ndice @@index([userId, billingMonth])",
          "âœ… Helpers implementados: deriveBillingMonth(txDate, closingDay, policy) e adjustToBusinessDay() em backend/src/utils/billingHelpers.ts com 235 linhas de JSDoc",
          "âœ… API atualizada: POST/PUT /api/expenses calculam billingMonth automaticamente; GET /api/expenses?mode=billing&month=YYYY-MM funcional",
          "âœ… ValidaÃ§Ã£o 422: Retorna erro se cartÃ£o nÃ£o tem closingDay configurado",
          "âœ… Backfill: Script backend/scripts/backfill-billing-month.ts (152 linhas) para preencher billingMonth retroativo",
          "âœ… Redis: Cache por billingMonth integrado; invalidaÃ§Ã£o em mutaÃ§Ãµes",
          "âœ… Docker: Build estÃ¡vel com enum atualizado (NEXT/PREVIOUS)",
          "âœ… Testes: billing.test.ts atualizado para novos valores de enum",
          "âœ… DocumentaÃ§Ã£o completa: MILESTONE_0_COMPLETE.md com 600+ linhas detalhando implementaÃ§Ã£o",
          "âœ… Script de migraÃ§Ã£o: migrate-billing-enum.ts criado para converter dados antigos",
          "âœ… MigraÃ§Ã£o executada: 5 cartÃµes atualizados de PREVIOUS_BUSINESS_DAY â†’ PREVIOUS no MongoDB",
          "âœ… Dockerfile atualizado: scripts/ e package.json copiados para runtime",
          "âœ… API Backend: GET /api/origins funcionando sem erros de enum",
          "âœ… Frontend atualizado: schemas.ts, types/index.ts e Cadastros.jsx com NEXT/PREVIOUS",
          "âœ… Guia de migraÃ§Ã£o: MIGRATION_ENUM_BILLING.md com 250+ linhas e checklist completo",
          "ğŸŸ¡ Frontend pendente: useExpenses mode=billing e UI de agrupamento por fatura (Todo #8)"
        ]
      },
      {
        "id": 15,
        "tag": "[Refactor] Service/Repository Layer",
        "status": "ğŸŸ¡ Planejado (NOVO)",
        "summary": "Separar responsabilidades em trÃªs camadas para clareza, testes e evoluÃ§Ã£o segura.",
        "notes": [
          "Routes: validaÃ§Ã£o + orquestraÃ§Ã£o; Services: regras; Repositories: Prisma-only.",
          "InjeÃ§Ã£o de dependÃªncia para facilitar mocks nos testes.",
          "CritÃ©rios de aceite: rotas finas; services sem import de Prisma.",
          "Riscos: refator parcelado; mitigar com feature toggles e suÃ­te de testes (#16)."
        ]
      },
      {
        "id": 18,
        "tag": "[Security] AutenticaÃ§Ã£o AvanÃ§ada (MFA + Google Login)",
        "status": "ğŸŸ¡ Planejado (NOVO)",
        "summary": "Adicionar MFA via Resend (OTP) e login social Google OAuth2, incluindo botÃ£o 'Entrar com o Google' na tela de login e fluxo completo de autenticaÃ§Ã£o.",
        "notes": [
          "âœ… BotÃ£o 'Entrar com o Google' exibido na tela de login (frontend)",
          "âœ… IntegraÃ§Ã£o com biblioteca oficial Google Sign-In (@react-oauth/google ou similar)",
          "âœ… client_id configurado via env frontend",
          "âœ… Ao clicar, inicia fluxo OAuth2 do Google e recebe token/cÃ³digo",
          "âœ… Frontend envia token/cÃ³digo para backend em /auth/google",
          "âœ… Backend valida token, autentica/cria usuÃ¡rio e retorna access/refresh token",
          "âœ… Tokens: refresh em cookie httpOnly, access em memÃ³ria (state)",
          "âœ… MFA opcional: envio e validaÃ§Ã£o de OTP via Resend (ou similar)",
          "âœ… Rotas: /auth/register, /auth/login, /auth/refresh, /auth/logout, /auth/resend, /auth/google",
          "âœ… CritÃ©rios de aceite: login Google end-to-end funcional, MFA opcional, UX fluida",
          "Riscos: fluxo OAuth mal configurado; mitigar com testes em sandbox, logs detalhados e validaÃ§Ã£o de estado/nonce"
        ]
      },
      {
        "id": 5,
        "tag": "[API] Ãndices e filtros UTC",
        "status": "ğŸŸ¢ Implementado",
        "summary": "Normalizar consultas mensais por UTC para evitar desvios de timezone.",
        "notes": [
          "@@index([userId, date]) e range por Date.UTC em filtros.",
          "CritÃ©rios de aceite: mesma query retorna os mesmos itens independente de TZ do host.",
          "Riscos: dados legados com TZ local; mitigado por conversÃ£o centralizada."
        ]
      },
      {
        "id": 6,
        "tag": "[FE] MUI Only Theme",
        "status": "ğŸŸ¢ Implementado",
        "summary": "Unificar design system em MUI e remover resÃ­duos de Tailwind.",
        "notes": [
          "ThemeProvider central; paleta/tipografia padronizadas.",
          "CritÃ©rios de aceite: nenhuma classe Tailwind ativa; UI consistente.",
          "Riscos: regressÃµes visuais; mitigar com verificaÃ§Ã£o manual das principais telas."
        ]
      },
      {
        "id": 7,
        "tag": "[FE] Hooks Tipados + Query Cache",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Refatorar useFinanceApp em hooks modulares com TanStack Query e serviÃ§os REST tipados.",
        "notes": [
          "useExpenses/useCatalogs/useSalary + Query Keys centralizadas.",
          "Axios com interceptors; tipagem de payloads/DTOs.",
          "CritÃ©rios de aceite: cache por mÃªs, invalidaÃ§Ã£o apÃ³s mutaÃ§Ãµes; zero acesso a LocalStorage.",
          "Riscos: chaves inconsistentes; mitigado por queryKeys.ts."
        ]
      },
      {
        "id": 8,
        "tag": "[FE/BE] NavegaÃ§Ã£o mensal + Cache Redis + Build Estabilizado",
        "status": "ğŸŸ¢ ConcluÃ­do (ValidaÃ§Ã£o Final OK)",
        "summary": "UX de navegaÃ§Ã£o temporal suave, cache distribuÃ­do Redis e build Docker multi-stage estÃ¡vel com Prisma.",
        "notes": [
          "MonthNavigator com Framer Motion; integraÃ§Ã£o useFinanceApp.",
          "Upstash Redis por usuÃ¡rio/mÃªs e invalidation pÃ³s-mutation.",
          "Docker: prisma generate no builder; cÃ³pia de .prisma para runtime.",
          "CritÃ©rios de aceite: logs com [CACHE HIT/MISS]; containers healthy.",
          "Riscos: WSL1; mitigar executando build em WSL2/Docker."
        ]
      },
      {
        "id": 4,
        "tag": "[Worker] RabbitMQ Robustness",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "ResiliÃªncia no processamento assÃ­ncrono de jobs de recorrÃªncia.",
        "notes": [
          "ReconexÃ£o com backoff, prefetch(10), ConfirmChannel, shutdown limpo.",
          "CritÃ©rios de aceite: worker permanece estÃ¡vel em reconexÃµes.",
          "Riscos: mensagens venenosas; mitigaÃ§Ã£o futura com DLQ (#14)."
        ]
      },
      {
        "id": 3,
        "tag": "[API] Security & Config ENV",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Endurecer configuraÃ§Ã£o e headers de seguranÃ§a na API.",
        "notes": [
          "Zod para ENVs crÃ­ticos; Helmet e CORS dinÃ¢mico.",
          "CritÃ©rios de aceite: boot falha sem ENVs; headers presentes.",
          "Riscos: CORS mal configurado; mitigar com allowlist por ambiente."
        ]
      },
      {
        "id": 2,
        "tag": "[DB] Float â†’ String precision",
        "status": "ğŸŸ¢ ConcluÃ­do",
        "summary": "Evitar erros de arredondamento em valores monetÃ¡rios.",
        "notes": [
          "Valores monetÃ¡rios como string + coerÃ§Ãµes nos helpers.",
          "CritÃ©rios de aceite: comparaÃ§Ã£o monetÃ¡ria determinÃ­stica.",
          "Riscos: parsing negligenciado; mitigado em helpers centralizados."
        ]
      },
      {
        "id": 1,
        "tag": "[BUG] ReplicaÃ§Ã£o e idempotÃªncia",
        "status": "ğŸŸ¢ Resolvido",
        "summary": "Eliminar duplicaÃ§Ãµes de recorrentes por meio de fingerprint Ãºnico.",
        "notes": [
          "Ãndice Ãºnico por fingerprint + backfill idempotente.",
          "CritÃ©rios de aceite: nenhuma duplicidade em replays.",
          "Riscos: colisÃ£o de fingerprint; mitigado com sal e campos chave."
        ]
      }
    ],
    "last_action": "SessÃ£o 10/11/2025: integraÃ§Ã£o Qodana (ativo), inÃ­cio da configuraÃ§Ã£o Semgrep, Snyk e ZAP, registro dos GitHub Secrets e template .env.example revisado. CD iniciado (Vercel + Render / Kubernetes OKE) e GitOps planejado.",
    "session_achievements": [
      "âœ… Qodana integrado e executando automaticamente em cada PR (com comentÃ¡rios no diff)",
      "âœ… Secrets e variÃ¡veis sensÃ­veis migrados para GitHub Secrets (sem leaks em logs)",
      "âœ… .env.example padronizado e revisado",
      "âœ… Render backend e Vercel frontend configurados com deploy manual pÃ³s-CI",
      "ğŸŸ¡ Semgrep, Snyk e ZAP configurando alertas e thresholds de bloqueio",
      "ğŸŸ¡ InÃ­cio da estruturaÃ§Ã£o de CD automatizado e futura arquitetura GitOps"
    ],
    "next_steps": [
      "Finalizar integraÃ§Ã£o dos scanners Semgrep, Snyk e OWASP ZAP no CI Security Analysis",
      "Refatorar workflows para consumir secrets via matrix/env-file",
      "Habilitar CD completo (auto deploy staging â†’ production via Render, Vercel e/ou Kubernetes)",
      "Implementar rollback automatizado e healthcheck de deploy",
      "Estruturar planejamento GitOps com Canary Deploy (v7.0 milestone)",
      "Atualizar documentaÃ§Ã£o dos fluxos de seguranÃ§a e CI/CD"
    ],
    "commit_template": "â€¢ [Feature/Refactor/Fix/Security] DescriÃ§Ã£o da mudanÃ§a.\nâ€¢ Relacionado ao(s) Milestone(s): #[ID]\nâ€¢ Verificado por: Qodana/Snyk/Semgrep/ZAP"
  }
}
