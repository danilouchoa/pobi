{
  "codex_memory": {
    "project": "Finance App Project",
    "version": "v6.3.0 (Auth httpOnly Cookies - Seguran√ßa Aprimorada)",
    "description": "Aplica√ß√£o fullstack de controle financeiro (React + Express + Prisma + MongoDB + RabbitMQ + Upstash Redis + httpOnly Cookies), com foco em modulariza√ß√£o, seguran√ßa, resili√™ncia, valida√ß√£o robusta e autentica√ß√£o segura.",
    "milestones": [
      {
        "codex_memory": {
          "project": "Finance App Project",
          "version": "v6.6.0 (CI/CD Seguro + Scanners SAST/DAST + GitOps Futuro)",
          "description": "Aplica√ß√£o fullstack de controle financeiro (React + Express + Prisma + MongoDB + RabbitMQ + Upstash Redis + httpOnly Cookies) com pipelines CI/CD integradas, automa√ß√£o de deploy (Vercel + Render), seguran√ßa cont√≠nua (Qodana, Semgrep, Snyk, OWASP ZAP) e planejamento de GitOps/Canary.",
          "milestones": [
              {
                "id": 21,
                "tag": "[Security/DX] Qodana, Semgrep, Snyk e OWASP ZAP Integrados",
                "status": "üü° Em progresso (Qodana ‚úÖ, demais configurando)",
                "summary": "Integra√ß√£o das ferramentas de an√°lise est√°tica e din√¢mica de seguran√ßa (SAST/DAST) nos pipelines GitHub Actions.",
                "notes": [
                  "‚úÖ Qodana JS ativo com workflow qodana.yml (CI Security Analysis)",
                  "‚úÖ 116 findings iniciais (76 ESLint, 4 hardcoded passwords, demais warnings de import e redund√¢ncia)",
                  "‚úÖ Coment√°rios autom√°ticos em PR via Qodana Bot",
                  "üü° Semgrep configurado para detectar inje√ß√µes, SSRF, secrets e XSS em JS/TS",
                  "üü° Snyk integrado para auditoria de vulnerabilidades npm/yarn (package.json + lockfiles)",
                  "üü° OWASP ZAP configurado para varredura DAST no ambiente staging (Kubernetes OKE) - detectando headers inseguros e endpoints expostos",
                  "üîí Severities High/Critical bloqueiam merge autom√°tico via required checks",
                  "üìä Security Dashboard consolidando m√©tricas por scanner e PR",
                  "üìò Documenta√ß√£o: SECURITY_SCANNERS.md"

                    "Regenerate actionable SARIF (‚â§30‚ÄØmin)

                    Download the latest artifact from the GitHub Action or rerun qodana scan locally with --output sarif.
                    Outcome: concrete file/line references so we aren‚Äôt chasing abstract rule names.
                    Batch-fix EditorConfig violations (‚âà45‚ÄØmin)

                    Normalize .editorconfig: keep a single root = true, collapse duplicate glob patterns, align indentation defaults.
                    Run eslint --fix / prettier --write across the repo to flush formatting drift.
                    Impact: clears 12 Critical findings and prevents repeated noise in future scans.
                    Triage Angular template hot spots (‚âà1‚ÄØh)

                    Use the refreshed SARIF to list offending templates, then fix structural directive stacking, ambiguous template refs, or incorrect *ng usage.
                    Validate via unit tests or Storybook snapshots where available.
                    Impact: removes the largest Critical cluster (27 rules) tied to customer-facing UI.
                    Validate CSS/PostCSS definitions (‚âà45‚ÄØmin)

                    Focus on CssInvalidPropertyValue/CssInvalidFunction violations: verify custom properties exist, drop experimental syntax not supported by our browser targets, lint with stylelint --fix.
                    Impact: 12 Critical issues with fast fixes and immediate UX improvement.
                    Re-run Qodana + wire the gate (‚â§30‚ÄØmin)

                    Execute the workflow after fixes; archive the SARIF to confirm Critical/High totals drop to zero.
                    Ensure the Qodana check stays blocking for severity ‚â• High (already enforced per codex notes)."
                ]
              },
              {
                "id": 22,
                "tag": "[Security] Gest√£o de Secrets e ENVs",
                "status": "üü¢ Conclu√≠do (Fase 1)",
                "summary": "Cadastro de vari√°veis sens√≠veis e tokens nos GitHub Secrets e oculta√ß√£o de valores em logs/pipelines.",
                "notes": [
                  "‚úÖ Todos os tokens, keys e conex√µes (.env) migrados para GitHub Secrets (org-level e reposit√≥rio)",
                  "‚úÖ Workflows atualizados para ler via secrets.GITHUB_TOKEN e secrets.PRODUCTION_ENV",
                  "‚úÖ Reposit√≥rio configurado com ENV placeholders (template .env.example atualizado)",
                  "‚úÖ Logs ofuscados em CI (masks adicionadas via core.setSecret)",
                  "üü° Pr√≥xima etapa: refatorar pipelines para injetar secrets diretamente em manifests Kubernetes (kubectl set env / kustomize patches)",
                  "üìò Documenta√ß√£o: ENV_SECURITY_GUIDE.md"
                ]
              },
              {
                "id": 23,
                "tag": "[CI/CD] Continuous Deployment no Kubernetes (OCI OKE)",
                "status": "üü° Em Progresso",
                "summary": "Implementa√ß√£o de CD automatizado com deploy seguro no cluster Kubernetes gratuito da Oracle Cloud (OKE).",
                "notes": [
                  "üß© Deploy automatizado via GitHub Actions ‚Üí kubectl apply com contexto configurado (OCI CLI + kubeconfig)",
                  "üß© Imagens publicadas no OCIR (Oracle Container Registry) com autentica√ß√£o via GitHub Secrets",
                  "‚úÖ Ambientes configurados: staging (namespace staging) e production (namespace production)",
                  "‚úÖ Branch main ‚Üí production | feature/* ‚Üí staging",
                  "‚öôÔ∏è Deploy automatizado no merge com CI verde e scanners sem falhas cr√≠ticas",
                  "üì¶ Rollback via Helm history / kubectl rollout undo",
                  "üü° Planejamento GitOps ‚Üí Canary Deploy (progressive rollout via tags e auto-promotion)",
                  "üìò Documenta√ß√£o: DEPLOY_PIPELINE_K8S_GUIDE.md"
                ]
              },
              {
                "id": 24,
                "tag": "[Security] GitOps & Canary Strategy (Planejado)",
                "status": "üü° Planejado",
                "summary": "Planejar e aplicar pr√°ticas GitOps com fluxos de Canary Deploy no Kubernetes de produ√ß√£o.",
                "notes": [
                  "üéØ Meta: adotar GitOps (ArgoCD ou FluxCD) para sincroniza√ß√£o declarativa de ambientes",
                  "üéØ Deploy Canary para valida√ß√£o progressiva de novas vers√µes",
                  "üéØ Automatizar rollback baseado em m√©tricas de healthcheck, logs e Prometheus metrics",
                  "üéØ Integrar com observabilidade futura (Grafana/Loki/Prometheus)",
                  "üéØ Documentar padr√µes: PR ‚Üí Deploy Canary ‚Üí Promo√ß√£o autom√°tica ap√≥s 95% sucesso",
                  "üìò Documenta√ß√£o: GITOPS_CANARY_PLAN.md"
                ]
              },
              {
                "id": 25,
                "tag": "[DX/Security] C√≥digo Seguro e Oculta√ß√£o de Vari√°veis",
                "status": "üü¢ Conclu√≠do",
                "summary": "Melhorias estruturais para ocultar vari√°veis e segredos no c√≥digo e pipelines.",
                "notes": [
                  "‚úÖ Substitui√ß√£o completa de vari√°veis hardcoded por process.env.*",
                  "‚úÖ Removidas credenciais mock de testes e substitu√≠das por fixtures seguras",
                  "‚úÖ C√≥digo revisado pelo Qodana e Semgrep (nenhum secret em plaintext)",
                  "‚úÖ README atualizado com diretrizes de .env seguro e m√°scaras de logs",
                  "‚úÖ Hist√≥rico das branches main e ci/qodana-environment reescrito via branch √≥rf√£ sanitized-* com secrets removidos e tags de backup (pre-sanitize-main / pre-sanitize-ci-qodana) em Nov/2025",
                  "üü° Pend√™ncia: propagar altera√ß√µes de vari√°veis para workflows CI/CD (n√£o aplicado ainda)",
                  "üìò Documenta√ß√£o: SAFE_ENV_CODING_GUIDE.md"
                ]
              },
              {
                "id": 20,
                "tag": "[DX] CI Pipeline (Backend & Frontend)",
                "status": "üü¢ Conclu√≠do",
                "summary": "Pipelines GitHub Actions para backend e frontend garantindo lint, build, testes, cobertura e prote√ß√£o de branch.",
                "notes": [
                  "‚úÖ Workflows ci-backend.yml e ci-frontend.yml ativos (push e PR para main)",
                  "‚úÖ Node 20 + cache npm (setup-node)",
                  "‚úÖ Etapas: install, lint, build/tsc, vitest + cobertura, upload artifacts",
                  "‚úÖ Status checks requeridos antes de merge em main",
                  "‚úÖ Auto-merge de Dependabot depende dos checks verdes",
                  "üìä M√©trica alvo: execu√ß√£o <5min total cada pipeline",
                  "üß™ Cobertura publicada como artifact para inspe√ß√£o",
                  "üîí Branch protection configurada (GH006 aplicado em push direto)"
                ]
              },
              {
                "id": 19,
                "tag": "[DX] Atualiza√ß√£o Autom√°tica de Depend√™ncias",
                "status": "üü¢ Conclu√≠do",
                "summary": "Dependabot di√°rio para backend e frontend com auto-label e auto-merge condicional.",
                "notes": [
                  "‚úÖ Arquivo dependabot.yml configurado (interval daily 14:02 BRT, timezone America/Sao_Paulo)",
                  "‚úÖ Labels autom√°ticas: dependencies, auto-update",
                  "‚úÖ Workflow dependabot-auto-merge.yml para fus√£o autom√°tica com CI verde",
                  "‚úÖ PRs recentes: bump express-rate-limit 8.2.1",
                  "‚úÖ Branch main protegida - merges apenas via PR",
                  "üìå Objetivo: nenhuma depend√™ncia cr√≠tica >1 vers√£o minor atrasada",
                  "üõ°Ô∏è Seguran√ßa: patches aplicados em <24h",
                  "üóÇÔ∏è Documenta√ß√£o no README (se√ß√£o Milestone #19)"
                ]
              },
              {
                "id": 9,
                "tag": "[FE] Toasts & Empty States",
                "status": "üü¢ Conclu√≠do",
                "summary": "Feedbacks visuais consistentes (toasts) e placeholders de listas vazias (empty states) implementados em todas as telas CRUD, com c√≥digo totalmente documentado.",
                "notes": [
                  "‚úÖ notistack instalado e SnackbarProvider configurado globalmente (top-right, max 3, 3s duration)",
                  "‚úÖ Hook useToast() criado com success/error/info/warning e preven√ß√£o de duplicidade (debounce 2s + timestamp)",
                  "‚úÖ Componente EmptyState.tsx (MUI) com props title/description/ctaLabel/onCtaClick/icon",
                  "‚úÖ mapBackendError() traduzindo c√≥digos t√©cnicos (E_VALIDATION, E_DUPLICATE, etc) em mensagens leg√≠veis",
                  "‚úÖ Toasts integrados em Lancamentos (5 opera√ß√µes), Cadastros (7 opera√ß√µes), Sal√°rio (2 opera√ß√µes)",
                  "‚úÖ EmptyStates integrados: Lancamentos (1), Categorias (1), Origens (1), Devedores (1)",
                  "‚úÖ 100% do c√≥digo comentado com JSDoc e documenta√ß√£o inline",
                  "‚úÖ Crit√©rios de aceite: 14 opera√ß√µes com toasts, 4 empty states, zero erros console",
                  "‚úÖ Documento completo: MILESTONE_9_COMPLETE.md com arquitetura e exemplos"
                ]
              },
              {
                "id": 17,
                "tag": "[DX] Storybook",
                "status": "ÔøΩ Conclu√≠do",
                "summary": "Storybook configurado com tema MUI, stories reais para MonthNavigator, KPI e EmptyState, sem exemplos quebrados.",
                "notes": [
                  "‚úÖ Storybook 10.x com Vite e ThemeProvider global",
                  "‚úÖ Stories reais: MonthNavigator, KPI, EmptyState",
                  "‚úÖ Remo√ß√£o de exemplos quebrados",
                  "‚úÖ Zero warnings/erros no build",
                  "‚úÖ Crit√©rios de aceite: stories reais, tema aplicado, sem exemplos quebrados"
                ]
              },
              {
                "id": 14,
                "tag": "[BE] Dead Letter Queue (DLQ)",
                "status": "üü¢ Conclu√≠do",
                "summary": "DLQ implementada no RabbitMQ com retry, backoff, endpoints admin e integra√ß√£o nos workers.",
                "notes": [
                  "‚úÖ DLQ via dead-letter-exchange e argumentos de fila",
                  "‚úÖ Retry autom√°tico com backoff exponencial",
                  "‚úÖ Endpoints admin: /api/dlq/stats, /api/dlq/messages, /api/dlq/reprocess/:id, /api/dlq/purge",
                  "‚úÖ Prote√ß√£o JWT nos endpoints",
                  "‚úÖ Logs detalhados de falhas e reprocessamentos",
                  "‚úÖ Workers bulk/recurring integrados com DLQ",
                  "‚úÖ Crit√©rios de aceite: mensagens na DLQ ap√≥s retries, admin funcional, testes manuais"
                ]
              },
              {
                "id": 10,
                "tag": "[DX] Healthchecks e Docker Prod",
                "status": "üü¢ Conclu√≠do",
                "summary": "Aprimorar observabilidade e robustez de execu√ß√£o em cont√™ineres com healthchecks completos.",
                "notes": [
                  "‚úÖ Endpoint /api/health: Verifica Mongo (ping), Redis (PING) e RabbitMQ (connect+channel)",
                  "‚úÖ Retorna JSON com status, uptime, lat√™ncia de cada depend√™ncia",
                  "‚úÖ Status HTTP: 200 (ok) | 503 (unhealthy/degraded)",
                  "‚úÖ Script health:db (check-db.ts): Verifica√ß√£o standalone do MongoDB com output detalhado",
                  "‚úÖ Healthcheck Docker backend: curl -f http://localhost:4000/api/health (interval: 30s)",
                  "‚úÖ Healthcheck Docker workers: kill -0 1 (verifica se PID 1 est√° vivo)",
                  "‚úÖ Healthcheck Docker mongo: mongosh --eval 'db.adminCommand(ping)'",
                  "‚úÖ Depends_on com condition: service_healthy - workers s√≥ iniciam ap√≥s backend healthy",
                  "‚úÖ Frontend depende de backend healthy - evita erros de conex√£o",
                  "‚úÖ Dockerfile: curl instalado no stage runtime para healthchecks",
                  "‚úÖ Todos os containers com STATUS=healthy validados via docker ps",
                  "‚úÖ Endpoint /ready: Readiness probe para compatibilidade futura com Kubernetes"
                ]
              },
              {
                "id": 11,
                "tag": "[Security] Valida√ß√£o de Rota (Zod)",
                "status": "üü¢ Conclu√≠do",
                "summary": "Sistema completo de valida√ß√£o de entrada (body/query/params) usando Zod, com middleware gen√©rica, schemas por recurso, feature flag e logs limpos.",
                "notes": [
                  "‚úÖ 5 schemas criados: expense (180L), origin (160L), auth (80L), salary (100L), catalog (90L)",
                  "‚úÖ Middleware validation.ts (290L): aceita body/query/params, retorna 400 padronizado, respeita VALIDATION_ENABLED",
                  "‚úÖ Formato de erro: { error, message, details: [{ field, message }] } - sem stack-trace",
                  "‚úÖ Feature flag VALIDATION_ENABLED no config.ts (default: true, permite rollback)",
                  "‚úÖ 18 rotas validadas: expenses (4), origins (4), auth (2), salary (4), debtors (4)",
                  "‚úÖ Valida√ß√µes monet√°rias: string formato '0.00' com regex /^\\d+\\.\\d{2}$/",
                  "‚úÖ Valida√ß√µes de datas: z.coerce.date() para ISO 8601, ranges validados",
                  "‚úÖ Valida√ß√µes de IDs: ObjectId MongoDB (24 chars hex) com regex",
                  "‚úÖ Valida√ß√£o condicional: closingDay obrigat√≥rio quando type='Cart√£o'",
                  "‚úÖ Seguran√ßa: .strict() rejeita campos extras (previne mass assignment)",
                  "‚úÖ Telemetria: contadores validationFailures (por rota) e validationFailuresByField",
                  "‚úÖ Fun√ß√£o getValidationMetrics() para debugging e monitoramento",
                  "‚úÖ Logs n√≠vel 'warn' SEM stack-trace para erros esperados de valida√ß√£o",
                  "‚úÖ Conven√ß√µes: createXxxSchema, updateXxxSchema (.partial()), queryXxxSchema, idParamSchema",
                  "‚úÖ Documenta√ß√£o completa consolidada no README.md (se√ß√£o Milestone #11)",
                  "üêõ v6.2.1 FIX: queryExpenseSchema ajustado para aceitar mode=calendar, year, limit=1000 (compatibilidade frontend)",
                  "üêõ v6.2.1 FIX: Middleware corrigido para n√£o sobrescrever req.query (read-only no Express)",
                  "‚úÖ v6.2.1 TEST: Todas as rotas validadas retornando 200 OK (expenses, origins, salary, debtors)",
                  "‚úÖ v6.2.1 STATUS: Sistema 100% funcional em produ√ß√£o sem erros 400/500"
                ]
              },
              {
                "id": 13,
                "tag": "[Security] Auth httpOnly Cookies",
                "status": "üü¢ Conclu√≠do",
                "summary": "Migra√ß√£o de localStorage (vulner√°vel a XSS) para cookies httpOnly + tokens em mem√≥ria, com refresh autom√°tico e valida√ß√£o real de credenciais.",
                "notes": [
                  "‚úÖ Arquitetura de 2 tokens: Access Token (15min, mem√≥ria) + Refresh Token (7d, cookie httpOnly)",
                  "‚úÖ Backend: 4 endpoints (login, register, refresh, logout) com bcrypt + JWT",
                  "‚úÖ Cookies httpOnly: secure (HTTPS prod), sameSite: strict (previne CSRF), inacess√≠vel via JS",
                  "‚úÖ Valida√ß√£o real: bcrypt.compare() para senhas, mensagens gen√©ricas (previne enumera√ß√£o)",
                  "‚úÖ Auto-refresh: Frontend intercepta 401, chama /auth/refresh automaticamente",
                  "‚úÖ CORS: credentials: true no backend + withCredentials: true no frontend",
                  "‚úÖ cookie-parser: Instalado no backend para ler req.cookies",
                  "‚úÖ Logs seguros: Login success/fail com email/IP (SEM senha/token)",
                  "‚úÖ Frontend: Token em mem√≥ria (state), user cacheado (localStorage), logout chama backend",
                  "‚úÖ Testes: register, login, refresh, logout, credenciais inv√°lidas - TODOS PASSANDO",
                  "‚úÖ Breaking change: Usu√°rios precisam fazer login novamente (tokens antigos inv√°lidos)",
                  "‚úÖ Documenta√ß√£o: 1000+ linhas no README com diagramas, fluxos, troubleshooting",
                  "‚úÖ Seguran√ßa: XSS prevenido (httpOnly), CSRF prevenido (sameSite: strict)",
                  "‚úÖ Depend√™ncias: cookie-parser@1.4.6 + @types/cookie-parser@1.4.7"
                ]
              },
              {
                "id": 11,
                "tag": "[Security] Valida√ß√£o de Rota (Zod)",
                "status": "ÔøΩ Conclu√≠do",
                "summary": "Sistema completo de valida√ß√£o de entrada (body/query/params) usando Zod, com middleware gen√©rica, schemas por recurso, feature flag e logs limpos.",
                "notes": [
                  "‚úÖ 5 schemas criados: expense (180L), origin (160L), auth (80L), salary (100L), catalog (90L)",
                  "‚úÖ Middleware validation.ts (290L): aceita body/query/params, retorna 400 padronizado, respeita VALIDATION_ENABLED",
                  "‚úÖ Formato de erro: { error, message, details: [{ field, message }] } - sem stack-trace",
                  "‚úÖ Feature flag VALIDATION_ENABLED no config.ts (default: true, permite rollback)",
                  "‚úÖ 18 rotas validadas: expenses (4), origins (4), auth (2), salary (4), debtors (4)",
                  "‚úÖ Valida√ß√µes monet√°rias: string formato '0.00' com regex /^\\d+\\.\\d{2}$/",
                  "‚úÖ Valida√ß√µes de datas: z.coerce.date() para ISO 8601, ranges validados",
                  "‚úÖ Valida√ß√µes de IDs: ObjectId MongoDB (24 chars hex) com regex",
                  "‚úÖ Valida√ß√£o condicional: closingDay obrigat√≥rio quando type='Cart√£o'",
                  "‚úÖ Seguran√ßa: .strict() rejeita campos extras (previne mass assignment)",
                  "‚úÖ Telemetria: contadores validationFailures (por rota) e validationFailuresByField",
                  "‚úÖ Fun√ß√£o getValidationMetrics() para debugging e monitoramento",
                  "‚úÖ Logs n√≠vel 'warn' SEM stack-trace para erros esperados de valida√ß√£o",
                  "‚úÖ Conven√ß√µes: createXxxSchema, updateXxxSchema (.partial()), queryXxxSchema, idParamSchema",
                  "‚úÖ Documenta√ß√£o completa consolidada no README.md (se√ß√£o Milestone #11)",
                  "üêõ v6.2.1 FIX: queryExpenseSchema ajustado para aceitar mode=calendar, year, limit=1000 (compatibilidade frontend)",
                  "üêõ v6.2.1 FIX: Middleware corrigido para n√£o sobrescrever req.query (read-only no Express)",
                  "‚úÖ v6.2.1 TEST: Todas as rotas validadas retornando 200 OK (expenses, origins, salary, debtors)",
                  "‚úÖ v6.2.1 STATUS: Sistema 100% funcional em produ√ß√£o sem erros 400/500"
                ]
              },
              {
                "id": 16,
                "tag": "[DX] Testes Automatizados",
                "status": "ÔøΩ Conclu√≠do",
                "summary": "Cobertura de testes automatizados (unit√°rios e integra√ß√£o) para backend (Vitest + Supertest) e frontend (RTL), garantindo estabilidade, confian√ßa e CI/CD robusta.",
                "notes": [
                  "‚úÖ Backend: Vitest + Supertest para rotas, services, workers, helpers (auth, expenses, billing, validation)",
                  "‚úÖ Testes de integra√ß√£o: /auth/login, /auth/refresh, /auth/logout (cookies), CRUD /expenses, filtros UTC, billingMonth",
                  "‚úÖ Testes unit√°rios: deriveBillingMonth(), adjustToBusinessDay(), workers (ACK/NACK, reconex√£o)",
                  "‚úÖ Mock global de clock (UTC fixo)",
                  "‚úÖ Seeds determin√≠sticos (seed=42), banco in-memory/mocks, sem tocar produ√ß√£o",
                  "‚úÖ Mocks centralizados (__mocks__/), reset antes de cada teste",
                  "‚úÖ Rodar via npm run test:backend, logs enxutos (--silent)",
                  "‚úÖ Frontend: React Testing Library (RTL) + Vitest",
                  "‚úÖ Testes de componentes: MonthNavigator (troca m√™s, labels, anima√ß√£o), EmptyState (renderiza√ß√£o, CTA)",
                  "‚úÖ Testes de hooks: useExpenses (fetch/mutation, toasts), useToast (debounce/chave √∫nica)",
                  "‚úÖ Testes de contexto: AuthContext (login/logout, mock cookies)",
                  "‚úÖ Providers mockados: QueryClient, Theme, Toast",
                  "‚úÖ Mocks de API: MSW ou axios-mock-adapter",
                  "‚úÖ Rodar via npm run test:frontend, cobertura >80% em /hooks e /components/ui",
                  "‚úÖ Cobertura m√≠nima 80% linhas/branches backend (src/services, src/routes, src/utils) e frontend (src/hooks, src/components/ui)",
                  "‚úÖ CI executa npm run test:backend e npm run test:frontend, falha se cobertura <80%",
                  "‚úÖ Relat√≥rio HTML (coverage/index.html)",
                  "‚úÖ Nomes descritivos, mocks centralizados, clock global, seeds fixos, testes idempotentes",
                  "‚úÖ Nenhum teste depende de lat√™ncia real, logs silenciosos, scripts package.json comentados",
                  "‚úÖ TESTING_GUIDE.md: estrutura, comandos, troubleshooting, tabela m√≥dulos‚Üîtestes, boas pr√°ticas",
                  "‚úÖ Crit√©rios de aceite: tudo acima implementado, sem flakiness, cobertura >80%, documenta√ß√£o completa"
                ]
              },
              {
                "id": 0,
                "tag": "[BUG] Fatura de Cart√£o (closingDay + dia √∫til + billingMonth)",
                "status": "üü¢ Conclu√≠do (Backend)",
                "summary": "Classificar despesas de cart√£o pela fatura correta com base no dia de fechamento (ajustado para dia √∫til), gravando billingMonth automaticamente.",
                "notes": [
                  "‚úÖ Schema atualizado: Origin.closingDay (Int), Origin.billingRolloverPolicy (NEXT|PREVIOUS), Expense.billingMonth (YYYY-MM) + √≠ndice @@index([userId, billingMonth])",
                  "‚úÖ Helpers implementados: deriveBillingMonth(txDate, closingDay, policy) e adjustToBusinessDay() em backend/src/utils/billingHelpers.ts com 235 linhas de JSDoc",
                  "‚úÖ API atualizada: POST/PUT /api/expenses calculam billingMonth automaticamente; GET /api/expenses?mode=billing&month=YYYY-MM funcional",
                  "‚úÖ Valida√ß√£o 422: Retorna erro se cart√£o n√£o tem closingDay configurado",
                  "‚úÖ Backfill: Script backend/scripts/backfill-billing-month.ts (152 linhas) para preencher billingMonth retroativo",
                  "‚úÖ Redis: Cache por billingMonth integrado; invalida√ß√£o em muta√ß√µes",
                  "‚úÖ Docker: Build est√°vel com enum atualizado (NEXT/PREVIOUS)",
                  "‚úÖ Testes: billing.test.ts atualizado para novos valores de enum",
                  "‚úÖ Documenta√ß√£o completa: MILESTONE_0_COMPLETE.md com 600+ linhas detalhando implementa√ß√£o",
                  "‚úÖ Script de migra√ß√£o: migrate-billing-enum.ts criado para converter dados antigos",
                  "‚úÖ Migra√ß√£o executada: 5 cart√µes atualizados de PREVIOUS_BUSINESS_DAY ‚Üí PREVIOUS no MongoDB",
                  "‚úÖ Dockerfile atualizado: scripts/ e package.json copiados para runtime",
                  "‚úÖ API Backend: GET /api/origins funcionando sem erros de enum",
                  "‚úÖ Frontend atualizado: schemas.ts, types/index.ts e Cadastros.jsx com NEXT/PREVIOUS",
                  "‚úÖ Guia de migra√ß√£o: MIGRATION_ENUM_BILLING.md com 250+ linhas e checklist completo",
                  "üü° Frontend pendente: useExpenses mode=billing e UI de agrupamento por fatura (Todo #8)"
                ]
              },
              {
                "id": 14,
                "tag": "[BE] Dead Letter Queue (DLQ)",
                "status": "ÔøΩ Conclu√≠do",
                "summary": "DLQ implementada no RabbitMQ com retry, backoff, endpoints admin e integra√ß√£o nos workers.",
                "notes": [
                  "‚úÖ DLQ via dead-letter-exchange e argumentos de fila",
                  "‚úÖ Retry autom√°tico com backoff exponencial",
                  "‚úÖ Endpoints admin: /api/dlq/stats, /api/dlq/messages, /api/dlq/reprocess/:id, /api/dlq/purge",
                  "‚úÖ Prote√ß√£o JWT nos endpoints",
                  "‚úÖ Logs detalhados de falhas e reprocessamentos",
                  "‚úÖ Workers bulk/recurring integrados com DLQ",
                  "‚úÖ Crit√©rios de aceite: mensagens na DLQ ap√≥s retries, admin funcional, testes manuais"
                ]
              },
              {
                "id": 15,
                "tag": "[Refactor] Service/Repository Layer",
                "status": "üü° Planejado (NOVO)",
                "summary": "Separar responsabilidades em tr√™s camadas para clareza, testes e evolu√ß√£o segura.",
                "notes": [
                  "Routes: valida√ß√£o + orquestra√ß√£o; Services: regras; Repositories: Prisma-only.",
                  "Inje√ß√£o de depend√™ncia para facilitar mocks nos testes.",
                  "Crit√©rios de aceite: rotas finas; services sem import de Prisma.",
                  "Riscos: refator parcelado; mitigar com feature toggles e su√≠te de testes (#16)."
                ]
              },
              {
                "id": 13,
                "tag": "[Security] Auth httpOnly Cookies",
                "status": "ÔøΩ Conclu√≠do",
                "summary": "Migra√ß√£o de localStorage (vulner√°vel a XSS) para cookies httpOnly + tokens em mem√≥ria, com refresh autom√°tico e valida√ß√£o real de credenciais.",
                "notes": [
                  "‚úÖ Arquitetura de 2 tokens: Access Token (15min, mem√≥ria) + Refresh Token (7d, cookie httpOnly)",
                  "‚úÖ Backend: 4 endpoints (login, register, refresh, logout) com bcrypt + JWT",
                  "‚úÖ Cookies httpOnly: secure (HTTPS prod), sameSite: strict (previne CSRF), inacess√≠vel via JS",
                  "‚úÖ Valida√ß√£o real: bcrypt.compare() para senhas, mensagens gen√©ricas (previne enumera√ß√£o)",
                  "‚úÖ Auto-refresh: Frontend intercepta 401, chama /auth/refresh automaticamente",
                  "‚úÖ CORS: credentials: true no backend + withCredentials: true no frontend",
                  "‚úÖ cookie-parser: Instalado no backend para ler req.cookies",
                  "‚úÖ Logs seguros: Login success/fail com email/IP (SEM senha/token)",
                  "‚úÖ Frontend: Token em mem√≥ria (state), user cacheado (localStorage), logout chama backend",
                  "‚úÖ Testes: register, login, refresh, logout, credenciais inv√°lidas - TODOS PASSANDO",
                  "‚úÖ Breaking change: Usu√°rios precisam fazer login novamente (tokens antigos inv√°lidos)",
                  "‚úÖ Documenta√ß√£o: 1000+ linhas no README com diagramas, fluxos, troubleshooting",
                  "‚úÖ Seguran√ßa: XSS prevenido (httpOnly), CSRF prevenido (sameSite: strict)",
                  "‚úÖ Depend√™ncias: cookie-parser@1.4.6 + @types/cookie-parser@1.4.7"
                ]
              },
              {
                "id": 18,
                "tag": "[Security] Autentica√ß√£o Avan√ßada (MFA + Google Login)",
                "status": "üü° Planejado (NOVO)",
                "summary": "Adicionar MFA via Resend (OTP) e login social Google OAuth2, incluindo bot√£o 'Entrar com o Google' na tela de login e fluxo completo de autentica√ß√£o.",
                "notes": [
                  "‚úÖ Bot√£o 'Entrar com o Google' exibido na tela de login (frontend)",
                  "‚úÖ Integra√ß√£o com biblioteca oficial Google Sign-In (@react-oauth/google ou similar)",
                  "‚úÖ client_id configurado via env frontend",
                  "‚úÖ Ao clicar, inicia fluxo OAuth2 do Google e recebe token/c√≥digo",
                  "‚úÖ Frontend envia token/c√≥digo para backend em /auth/google",
                  "‚úÖ Backend valida token, autentica/cria usu√°rio e retorna access/refresh token",
                  "‚úÖ Tokens: refresh em cookie httpOnly, access em mem√≥ria (state)",
                  "‚úÖ MFA opcional: envio e valida√ß√£o de OTP via Resend (ou similar)",
                  "‚úÖ Rotas: /auth/register, /auth/login, /auth/refresh, /auth/logout, /auth/resend, /auth/google",
                  "‚úÖ Crit√©rios de aceite: login Google end-to-end funcional, MFA opcional, UX fluida",
                  "Riscos: fluxo OAuth mal configurado; mitigar com testes em sandbox, logs detalhados e valida√ß√£o de estado/nonce"
                ]
              },
              {
                "id": 5,
                "tag": "[API] √çndices e filtros UTC",
                "status": "üü¢ Implementado",
                "summary": "Normalizar consultas mensais por UTC para evitar desvios de timezone.",
                "notes": [
                  "@@index([userId, date]) e range por Date.UTC em filtros.",
                  "Crit√©rios de aceite: mesma query retorna os mesmos itens independente de TZ do host.",
                  "Riscos: dados legados com TZ local; mitigado por convers√£o centralizada."
                ]
              },
              {
                "id": 6,
                "tag": "[FE] MUI Only Theme",
                "status": "üü¢ Implementado",
                "summary": "Unificar design system em MUI e remover res√≠duos de Tailwind.",
                "notes": [
                  "ThemeProvider central; paleta/tipografia padronizadas.",
                  "Crit√©rios de aceite: nenhuma classe Tailwind ativa; UI consistente.",
                  "Riscos: regress√µes visuais; mitigar com verifica√ß√£o manual das principais telas."
                ]
              },
              {
                "id": 7,
                "tag": "[FE] Hooks Tipados + Query Cache",
                "status": "üü¢ Conclu√≠do",
                "summary": "Refatorar useFinanceApp em hooks modulares com TanStack Query e servi√ßos REST tipados.",
                "notes": [
                  "useExpenses/useCatalogs/useSalary + Query Keys centralizadas.",
                  "Axios com interceptors; tipagem de payloads/DTOs.",
                  "Crit√©rios de aceite: cache por m√™s, invalida√ß√£o ap√≥s muta√ß√µes; zero acesso a LocalStorage.",
                  "Riscos: chaves inconsistentes; mitigado por queryKeys.ts."
                ]
              },
              {
                "id": 8,
                "tag": "[FE/BE] Navega√ß√£o mensal + Cache Redis + Build Estabilizado",
                "status": "üü¢ Conclu√≠do (Valida√ß√£o Final OK)",
                "summary": "UX de navega√ß√£o temporal suave, cache distribu√≠do Redis e build Docker multi-stage est√°vel com Prisma.",
                "notes": [
                  "MonthNavigator com Framer Motion; integra√ß√£o useFinanceApp.",
                  "Upstash Redis por usu√°rio/m√™s e invalidation p√≥s-mutation.",
                  "Docker: prisma generate no builder; c√≥pia de .prisma para runtime.",
                  "Crit√©rios de aceite: logs com [CACHE HIT/MISS]; containers healthy.",
                  "Riscos: WSL1; mitigar executando build em WSL2/Docker."
                ]
              },
              {
                "id": 4,
                "tag": "[Worker] RabbitMQ Robustness",
                "status": "üü¢ Conclu√≠do",
                "summary": "Resili√™ncia no processamento ass√≠ncrono de jobs de recorr√™ncia.",
                "notes": [
                  "Reconex√£o com backoff, prefetch(10), ConfirmChannel, shutdown limpo.",
                  "Crit√©rios de aceite: worker permanece est√°vel em reconex√µes.",
                  "Riscos: mensagens venenosas; mitiga√ß√£o futura com DLQ (#14)."
                ]
              },
              {
                "id": 3,
                "tag": "[API] Security & Config ENV",
                "status": "üü¢ Conclu√≠do",
                "summary": "Endurecer configura√ß√£o e headers de seguran√ßa na API.",
                "notes": [
                  "Zod para ENVs cr√≠ticos; Helmet e CORS din√¢mico.",
                  "Crit√©rios de aceite: boot falha sem ENVs; headers presentes.",
                  "Riscos: CORS mal configurado; mitigar com allowlist por ambiente."
                ]
              },
              {
                "id": 2,
                "tag": "[DB] Float ‚Üí String precision",
                "status": "üü¢ Conclu√≠do",
                "summary": "Evitar erros de arredondamento em valores monet√°rios.",
                "notes": [
                  "Valores monet√°rios como string + coer√ß√µes nos helpers.",
                  "Crit√©rios de aceite: compara√ß√£o monet√°ria determin√≠stica.",
                  "Riscos: parsing negligenciado; mitigado em helpers centralizados."
                ]
              },
              {
                "id": 1,
                "tag": "[BUG] Replica√ß√£o e idempot√™ncia",
                "status": "üü¢ Resolvido",
                "summary": "Eliminar duplica√ß√µes de recorrentes por meio de fingerprint √∫nico.",
                "notes": [
                  "√çndice √∫nico por fingerprint + backfill idempotente.",
                  "Crit√©rios de aceite: nenhuma duplicidade em replays.",
                  "Riscos: colis√£o de fingerprint; mitigado com sal e campos chave."
                ]
              }
            ],
            "last_action": "Sess√£o 10/11/2025: integra√ß√£o Qodana (ativo), in√≠cio da configura√ß√£o Semgrep, Snyk e ZAP, registro dos GitHub Secrets e template .env.example revisado. CD iniciado (Vercel + Render) e GitOps planejado.",
            "session_achievements": [
              "‚úÖ Qodana integrado e executando automaticamente em cada PR (com coment√°rios no diff)",
              "‚úÖ Secrets e vari√°veis sens√≠veis migrados para GitHub Secrets (sem leaks em logs)",
              "‚úÖ .env.example padronizado e revisado",
              "‚úÖ Render backend e Vercel frontend configurados com deploy manual p√≥s-CI",
              "üü° Semgrep, Snyk e ZAP configurando alertas e thresholds de bloqueio",
              "üü° In√≠cio da estrutura√ß√£o de CD automatizado e futura arquitetura GitOps"
            ],
            "next_steps": [
              "Finalizar integra√ß√£o dos scanners Semgrep, Snyk e OWASP ZAP no CI Security Analysis",
              "Refatorar workflows para consumir secrets via matrix/env-file",
              "Habilitar CD completo (auto deploy staging ‚Üí production via Render e Vercel)",
              "Implementar rollback automatizado e healthcheck de deploy",
              "Estruturar planejamento GitOps com Canary Deploy (v7.0 milestone)",
              "Atualizar documenta√ß√£o dos fluxos de seguran√ßa e CI/CD"
            ],
            "commit_template": "‚Ä¢ [Feature/Refactor/Fix/Security] Descri√ß√£o da mudan√ßa.\n‚Ä¢ Relacionado ao(s) Milestone(s): #[ID]\n‚Ä¢ Verificado por: Qodana/Snyk/Semgrep/ZAP"
          }
        }
      ]
    }
  }